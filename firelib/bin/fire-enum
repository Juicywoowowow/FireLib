#!/usr/bin/env python3
"""
fire-enum - System enumeration for pentesting
"""

import sys
import os
import subprocess
import platform

def run_cmd(cmd):
    """Run command and return output"""
    try:
        result = subprocess.run(cmd, shell=True, capture_output=True, text=True, timeout=5)
        return result.stdout.strip()
    except:
        return ""

def section(title):
    """Print section header"""
    print(f"\n{'='*50}")
    print(f"{title}")
    print('='*50)

def main():
    print("Firelib System Enumeration")
    
    # System Info
    section("SYSTEM INFORMATION")
    print(f"OS: {platform.system()}")
    print(f"Release: {platform.release()}")
    print(f"Architecture: {platform.machine()}")
    print(f"Hostname: {platform.node()}")
    
    # User Info
    section("USER INFORMATION")
    print(f"Current User: {os.getenv('USER', 'unknown')}")
    print(f"UID: {os.getuid()}")
    print(f"GID: {os.getgid()}")
    print(f"Home: {os.getenv('HOME', 'unknown')}")
    print(f"Shell: {os.getenv('SHELL', 'unknown')}")
    
    # Network Info
    section("NETWORK INFORMATION")
    ip_output = run_cmd("ip addr show 2>/dev/null || ifconfig 2>/dev/null")
    if ip_output:
        for line in ip_output.split('\n')[:20]:
            if 'inet' in line or 'wlan' in line or 'eth' in line:
                print(line.strip())
    
    # Processes
    section("RUNNING PROCESSES (Top 10)")
    ps_output = run_cmd("ps aux 2>/dev/null | head -11")
    if ps_output:
        print(ps_output)
    
    # Environment
    section("ENVIRONMENT VARIABLES")
    important_vars = ['PATH', 'PREFIX', 'HOME', 'SHELL', 'TMPDIR', 'LD_LIBRARY_PATH']
    for var in important_vars:
        value = os.getenv(var, '')
        if value:
            print(f"{var}={value}")
    
    # Storage
    section("STORAGE INFORMATION")
    df_output = run_cmd("df -h 2>/dev/null")
    if df_output:
        print(df_output)
    
    # Installed Packages (Termux)
    section("INSTALLED PACKAGES (Sample)")
    pkg_output = run_cmd("pkg list-installed 2>/dev/null | head -20")
    if pkg_output:
        print(pkg_output)
    else:
        print("Not available or not in Termux")
    
    print("\n" + "="*50)
    print("[*] Enumeration complete")

if __name__ == '__main__':
    main()
